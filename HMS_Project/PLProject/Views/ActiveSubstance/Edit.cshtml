@model ActiveSubstanceViewModel

@{
	ViewData["Title"] = "Edit";
}

<h1 class="mb-4">Active Substance Edit</h1>

<div class="container">
	<!-- Active Substance Name -->
	<div class="form-group mb-3">
		<label asp-for="ActiveSubstancesName" class="form-label fw-bold"></label>
		<input asp-for="ActiveSubstancesName" class="form-control form-control-plaintext ps-1" readonly />
		<span asp-validation-for="ActiveSubstancesName" class="text-danger"></span>
	</div>

	<!-- Interactions with Other Substances -->
	<div class="mb-4">
		<h4 class="mb-3">Interactions with Other Active Substances</h4>
		@if (Model.Interactions.Count() > 0)
		{
			<div class="table-responsive">
				<table class="table table-hover table-bordered">
					<thead class="table-dark">
						<tr>
							<th>@Html.DisplayNameFor(a => a.Interactions.First().OtherSubstanceName)</th>
							<th>@Html.DisplayNameFor(a => a.Interactions.First().Interaction)</th>
							<th>Edite</th>
							<th>Delete</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var Substance in Model.Interactions)
						{
							<tr class="align-middle">
								<td>@Substance.OtherSubstanceName</td>
								<td>@Substance.Interaction , @Substance.ActSubId</td>

								<td>
									<a asp-controller="ActiveSubstance" asp-action="Edit" asp-route-ActId="@Model.Id" asp-route-InteractId="@Substance.ActSubId" class="btn btn-success" title="Update this record">
										<i class="fas fa-edit"></i> Edite
									</a>
								</td>
								<td>
									<form asp-controller="ActiveSubstance" asp-action="ActSubstDelete" method="post">
										<input type="hidden" name="ActId" value="@Model.Id" />
										<input type="hidden" name="InteractId" value="@Substance.ActSubId" />
										<button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this?');">
											<i class="fas fa-trash"></i> Delete
										</button>
									</form>
								</td>
								
							</tr>
						}
					</tbody>
				</table>
			</div>
		}
		else
		{
			<div class="alert alert-info mt-3">
				<i class="fas fa-info-circle"></i> No interactions with other active substances found.
			</div>
		}
	</div>

	<!-- Medications with Active Substance -->
	<div class="mb-4">
		<h4 class="mb-3">Medications Containing This Active Substance</h4>
		@if (Model.Medications.Count() > 0)
		{
			<div class="table-responsive">
				<table class="table table-hover table-bordered">
					<thead class="table-dark">
						<tr>
							<th>@Html.DisplayNameFor(a => a.Medications.First().MedName)</th>
							<th>@Html.DisplayNameFor(a => a.Medications.First().Strength)</th>
							<th>Delete</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var Medication in Model.Medications)
						{
							<tr class="align-middle">
								<td>@Medication.MedName</td>
								<td>@Medication.Strength</td>
								<td>
									<a asp-controller="ActiveSubstance" asp-action="Delete" asp-route-ActId="@Model.Id" asp-route-Id="@Medication.Id" class="btn btn-danger" title="Delete this record" onclick="return confirm('Are you sure you want to delete this?');">
										<i class="fas fa-trash"></i> Delete
									</a>
								</td>
							</tr>
						}
					</tbody>
				</table>
			</div>
		}
		else
		{
			<div class="alert alert-info mt-3">
				<i class="fas fa-info-circle"></i> No medications found containing this active substance.
			</div>
		}
	</div>

	<div class="mt-4">
		<a asp-controller="ActiveSubstance" asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">
			<i class="fas fa-edit"></i> Edit
		</a>
		<a asp-controller="ActiveSubstance" asp-action="Index" class="btn btn-secondary ms-2">
			<i class="fas fa-arrow-left"></i> Back To List
		</a>
	</div>
</div>
